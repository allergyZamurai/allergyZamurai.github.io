<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±Ÿæˆ¸åŸå¤–å €è·¡ä¸€å‘¨ãƒ«ãƒ¼ãƒˆ</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .header h1 {
            margin: 0 0 10px 0;
            font-size: clamp(1.5em, 4vw, 2.5em);
            font-weight: 300;
        }
        .header p {
            margin: 0;
            opacity: 0.9;
            font-size: clamp(0.9em, 2vw, 1.1em);
        }
        .map-container {
            position: relative;
            padding: 15px;
        }
        #map {
            height: 500px;
            width: 100%;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .custom-marker {
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            border: 3px solid white;
            transition: all 0.3s ease;
        }
        .custom-marker:hover {
            transform: scale(1.2);
        }
        .legend {
            position: absolute;
            top: 25px;
            right: 25px;
            background: rgba(255,255,255,0.95);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            font-size: 0.8em;
            z-index: 1000;
            max-width: 200px;
        }
        .legend h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 1em;
            border-bottom: 1px solid #3498db;
            padding-bottom: 5px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 8px;
            border: 2px solid white;
            box-shadow: 0 1px 4px rgba(0,0,0,0.2);
        }
        .info-panel {
            background: #f8f9fa;
            padding: 20px;
            border-top: 1px solid #e9ecef;
        }
        .route-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .info-card {
            background: white;
            padding: 18px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-left: 4px solid #3498db;
            transition: transform 0.3s ease;
        }
        .info-card:hover {
            transform: translateY(-2px);
        }
        .info-card h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 1.1em;
        }
        .info-card p {
            margin: 0;
            color: #555;
            line-height: 1.6;
            font-size: 0.9em;
        }
        .stations-list {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .stations-list h3 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 1.2em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }
        .station-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 8px;
            margin-bottom: 5px;
        }
        .station-item:hover {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            transform: translateX(5px);
        }
        .station-item:last-child {
            border-bottom: none;
        }
        .station-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            font-size: 0.8em;
            color: white;
            flex-shrink: 0;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        .station-info {
            flex: 1;
            min-width: 0;
        }
        .station-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 4px;
            font-size: 0.9em;
        }
        .station-detail {
            color: #666;
            font-size: 0.8em;
            line-height: 1.4;
        }
        .controls {
            margin: 15px 0;
            text-align: center;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
            flex: 1;
            min-width: 120px;
            max-width: 180px;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        
        /* ã‚¹ãƒãƒ›å¯¾å¿œ */
        @media (max-width: 768px) {
            body { padding: 5px; }
            .container { border-radius: 10px; }
            .header { padding: 15px; }
            .map-container { padding: 10px; }
            #map { height: 400px; }
            .legend { 
                top: 10px; 
                right: 10px; 
                max-width: 150px;
                font-size: 0.7em;
                padding: 10px;
            }
            .info-panel { padding: 15px; }
            .route-info { grid-template-columns: 1fr; gap: 10px; }
            .controls { flex-direction: column; align-items: stretch; }
            .btn { max-width: none; margin: 5px 0; }
        }

        /* Leafletã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
        .leaflet-popup-content-wrapper {
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .leaflet-popup-content {
            margin: 13px 19px;
            line-height: 1.5;
        }
        .popup-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.1em;
        }
        .popup-desc {
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ æ±Ÿæˆ¸åŸå¤–å €è·¡ä¸€å‘¨ãƒ«ãƒ¼ãƒˆ</h1>
            <p>æ±Ÿæˆ¸æ™‚ä»£ã®å¤–å €ã®ç—•è·¡ã‚’è¾¿ã‚‹æ­´å²æ•£æ­©ã‚³ãƒ¼ã‚¹ï¼ˆç´„15kmï¼‰</p>
        </div>
        
        <div class="map-container">
            <div id="map"></div>
            
            <div class="legend">
                <h4>ğŸ“ ãƒ«ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰</h4>
                <div class="legend-item">
                    <div class="legend-color" style="background: #27ae60;"></div>
                    <span>ã‚¹ã‚¿ãƒ¼ãƒˆ</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #8e44ad;"></div>
                    <span>ã‚´ãƒ¼ãƒ«</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #3498db;"></div>
                    <span>é€šéç‚¹</span>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn" onclick="showFullRoute()">ğŸ—ºï¸ å…¨ãƒ«ãƒ¼ãƒˆè¡¨ç¤º</button>
                <button class="btn" onclick="animateRoute()">ğŸ“ é †ç•ªã«è¡¨ç¤º</button>
                <button class="btn" onclick="toggleRoute()">ğŸš¶ ãƒ«ãƒ¼ãƒˆè¡¨ç¤ºåˆ‡æ›¿</button>
            </div>
        </div>
        
        <div class="info-panel">
            <div class="route-info">
                <div class="info-card">
                    <h3>ğŸ“ ãƒ«ãƒ¼ãƒˆè©³ç´°</h3>
                    <p>ç·è·é›¢ï¼šç´„15km<br>
                    æ‰€è¦æ™‚é–“ï¼š3-4æ™‚é–“<br>
                    æ­©æ•°ï¼šç´„20,000æ­©<br>
                    æ¨™é«˜å·®ï¼šç´„50m</p>
                </div>
                <div class="info-card">
                    <h3>ğŸŒŸ è¦‹ã©ã“ã‚</h3>
                    <p>æ±Ÿæˆ¸åŸã®æ­´å²éºæ§‹ã€ç¾ä»£ã®æ±äº¬éƒ½å¿ƒéƒ¨ã®æ™¯è¦³ã€å››å­£æŠ˜ã€…ã®è‡ªç„¶ã€çš‡å±…å¤–è‹‘ã®ç¾ã—ã„åº­åœ’ã‚’æ¥½ã—ã‚ã¾ã™ã€‚</p>
                </div>
                <div class="info-card">
                    <h3>ğŸš‡ ã‚¢ã‚¯ã‚»ã‚¹æŠœç¾¤</h3>
                    <p>å…¨ã¦ã®é§…ã§è¤‡æ•°è·¯ç·šãŒåˆ©ç”¨å¯èƒ½ã€‚ã©ã®é§…ã‹ã‚‰ã§ã‚‚ã‚¹ã‚¿ãƒ¼ãƒˆãƒ»ã‚´ãƒ¼ãƒ«ã§ãã€é€”ä¸­é›¢è„±ã‚‚å®¹æ˜“ã§ã™ã€‚</p>
                </div>
            </div>
            
            <div class="stations-list">
                <h3>ğŸ“ ä¸»è¦é€šéãƒã‚¤ãƒ³ãƒˆï¼ˆã‚¯ãƒªãƒƒã‚¯ã§åœ°å›³ä¸Šã«è¡¨ç¤ºï¼‰</h3>
                <div class="station-item" onclick="focusPoint(0)">
                    <div class="station-number" style="background: #27ae60;">S</div>
                    <div class="station-info">
                        <div class="station-name">é£¯ç”°æ©‹é§…ãƒ»å¤–å €å…¬åœ’</div>
                        <div class="station-detail">å¤–å €ã®ç—•è·¡ãŒæœ€ã‚‚æ®‹ã‚‹åŒºé–“ã€‚æ¡œã®åæ‰€ã¨ã—ã¦æœ‰å</div>
                    </div>
                </div>
                <div class="station-item" onclick="focusPoint(1)">
                    <div class="station-number" style="background: #3498db;">1</div>
                    <div class="station-info">
                        <div class="station-name">å››ãƒ„è°·é§…ãƒ»å››ãƒ„è°·è¦‹é™„è·¡</div>
                        <div class="station-detail">æ±Ÿæˆ¸åŸã®çŸ³å£ãŒç¾å­˜ã€‚ä¸Šæ™ºå¤§å­¦å´ã«è¦‹å­¦å¯èƒ½</div>
                    </div>
                </div>
                <div class="station-item" onclick="focusPoint(2)">
                    <div class="station-number" style="background: #e74c3c;">2</div>
                    <div class="station-info">
                        <div class="station-name">èµ¤å‚è¦‹é™„é§…ãƒ»å¼æ…¶æ©‹</div>
                        <div class="station-detail">èµ¤å‚å¾¡ç”¨åœ°ã®ç·‘ã¨å €è·¡ã®çŸ³å£ãŒç¾ã—ã„</div>
                    </div>
                </div>
                <div class="station-item" onclick="focusPoint(3)">
                    <div class="station-number" style="background: #f39c12;">3</div>
                    <div class="station-info">
                        <div class="station-name">è™ãƒé–€ãƒ»æ„›å®•ç¥ç¤¾</div>
                        <div class="station-detail">å‡ºä¸–ã®çŸ³æ®µã§æœ‰åã€‚23åŒºå†…ã§æœ€ã‚‚é«˜ã„è‡ªç„¶ã®å±±</div>
                    </div>
                </div>
                <div class="station-item" onclick="focusPoint(4)">
                    <div class="station-number" style="background: #9b59b6;">4</div>
                    <div class="station-info">
                        <div class="station-name">æ–°æ©‹ãƒ»æ±ç•™</div>
                        <div class="station-detail">æ±Ÿæˆ¸æ™‚ä»£ã®æµ·å²¸ç·šè·¡ã€‚ç¾ä»£çš„ãªé«˜å±¤ãƒ“ãƒ«ç¾¤</div>
                    </div>
                </div>
                <div class="station-item" onclick="focusPoint(5)">
                    <div class="station-number" style="background: #1abc9c;">5</div>
                    <div class="station-info">
                        <div class="station-name">éŠ€åº§ãƒ»æ•°å¯„å±‹æ©‹è·¡</div>
                        <div class="station-detail">å¤–å €æœ€å—ç«¯ã€‚ç¾åœ¨ã¯é¦–éƒ½é«˜é€ŸãŒé€šã‚‹</div>
                    </div>
                </div>
                <div class="station-item" onclick="focusPoint(6)">
                    <div class="station-number" style="background: #34495e;">6</div>
                    <div class="station-info">
                        <div class="station-name">å¤§æ‰‹ç”ºãƒ»å’Œç”°å€‰é–€</div>
                        <div class="station-detail">æ±Ÿæˆ¸åŸæœ¬ä¸¸ã«æœ€ã‚‚è¿‘ã„ã‚¨ãƒªã‚¢ã€‚çš‡å±…å¤–è‹‘ã®ç¾ã—ã„æ™¯è¦³</div>
                    </div>
                </div>
                <div class="station-item" onclick="focusPoint(7)">
                    <div class="station-number" style="background: #e67e22;">7</div>
                    <div class="station-info">
                        <div class="station-name">ç¥ç”°ãƒ»å¸¸ç›¤æ©‹è·¡</div>
                        <div class="station-detail">æ±Ÿæˆ¸åŸã¸ã®æ­£å¼ãªå…¥å£ã ã£ãŸå ´æ‰€ã€‚ç¾åœ¨ã¯é¦–éƒ½é«˜é€Ÿä¸‹</div>
                    </div>
                </div>
                <div class="station-item" onclick="focusPoint(8)">
                    <div class="station-number" style="background: #8e44ad;">G</div>
                    <div class="station-info">
                        <div class="station-name">é£¯ç”°æ©‹é§…ï¼ˆã‚´ãƒ¼ãƒ«ï¼‰</div>
                        <div class="station-detail">ä¸€å‘¨å®Œäº†ï¼é”æˆæ„Ÿã‚’å‘³ã‚ã„ãªãŒã‚‰é›»è»Šã§å¸°å®…</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    
    <script>
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®å®šç¾©
    let map;
    const markers = [];
    let polyline;
    let animationInterval;
    
    // ãƒ«ãƒ¼ãƒˆãƒã‚¤ãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿
    const routePoints = [
        {lat: 35.7022, lng: 139.7445, name: "é£¯ç”°æ©‹é§…ãƒ»å¤–å €å…¬åœ’", desc: "å¤–å €ã®ç—•è·¡ãŒæœ€ã‚‚æ®‹ã‚‹åŒºé–“ã€‚æ¡œã®åæ‰€ã¨ã—ã¦æœ‰åã€‚", color: "#27ae60", label: "S"},
        {lat: 35.6956, lng: 139.7313, name: "å››ãƒ„è°·é§…ãƒ»å››ãƒ„è°·è¦‹é™„è·¡", desc: "æ±Ÿæˆ¸åŸã®çŸ³å£ãŒç¾å­˜ã€‚ä¸Šæ™ºå¤§å­¦å´ã«è¦‹å­¦å¯èƒ½ã€‚", color: "#3498db", label: "1"},
        {lat: 35.6794, lng: 139.7368, name: "èµ¤å‚è¦‹é™„é§…ãƒ»å¼æ…¶æ©‹", desc: "èµ¤å‚å¾¡ç”¨åœ°ã®ç·‘ã¨å €è·¡ã®çŸ³å£ãŒç¾ã—ã„ã€‚", color: "#e74c3c", label: "2"},
        {lat: 35.6681, lng: 139.7516, name: "è™ãƒé–€ãƒ»æ„›å®•ç¥ç¤¾", desc: "å‡ºä¸–ã®çŸ³æ®µã§æœ‰åã€‚23åŒºå†…ã§æœ€ã‚‚é«˜ã„è‡ªç„¶ã®å±±ã€‚", color: "#f39c12", label: "3"},
        {lat: 35.6654, lng: 139.7587, name: "æ–°æ©‹ãƒ»æ±ç•™", desc: "æ±Ÿæˆ¸æ™‚ä»£ã®æµ·å²¸ç·šè·¡ã€‚ç¾ä»£çš„ãªé«˜å±¤ãƒ“ãƒ«ç¾¤ã€‚", color: "#9b59b6", label: "4"},
        {lat: 35.6719, lng: 139.7648, name: "éŠ€åº§ãƒ»æ•°å¯„å±‹æ©‹è·¡", desc: "å¤–å €æœ€å—ç«¯ã€‚ç¾åœ¨ã¯é¦–éƒ½é«˜é€ŸãŒé€šã‚‹ã€‚", color: "#1abc9c", label: "5"},
        {lat: 35.6814, lng: 139.7661, name: "å¤§æ‰‹ç”ºãƒ»å’Œç”°å€‰é–€", desc: "æ±Ÿæˆ¸åŸæœ¬ä¸¸ã«æœ€ã‚‚è¿‘ã„ã‚¨ãƒªã‚¢ã€‚çš‡å±…å¤–è‹‘ã®ç¾ã—ã„æ™¯è¦³ã€‚", color: "#34495e", label: "6"},
        {lat: 35.6916, lng: 139.7707, name: "ç¥ç”°ãƒ»å¸¸ç›¤æ©‹è·¡", desc: "æ±Ÿæˆ¸åŸã¸ã®æ­£å¼ãªå…¥å£ã ã£ãŸå ´æ‰€ã€‚ç¾åœ¨ã¯é¦–éƒ½é«˜é€Ÿä¸‹ã€‚", color: "#e67e22", label: "7"},
        {lat: 35.7022, lng: 139.7445, name: "é£¯ç”°æ©‹é§…ï¼ˆã‚´ãƒ¼ãƒ«ï¼‰", desc: "ä¸€å‘¨å®Œäº†ï¼é”æˆæ„Ÿã‚’å‘³ã‚ã„ãªãŒã‚‰é›»è»Šã§å¸°å®…ã€‚", color: "#8e44ad", label: "G"}
    ];

    // åœ°å›³ã‚’åˆæœŸåŒ–ã™ã‚‹é–¢æ•°
    function initMap() {
        // æ—¢å­˜ã®ãƒãƒƒãƒ—ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚ã‚Œã°å‰Šé™¤
        if (map) {
            map.remove();
        }
        
        // åœ°å›³ã‚’ä½œæˆ
        map = L.map('map').setView([35.6850, 139.7514], 14);
        
        // OpenStreetMapã‚¿ã‚¤ãƒ«ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¿½åŠ 
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 18,
        }).addTo(map);
        
        // ãƒãƒ¼ã‚«ãƒ¼ã¨ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’è¿½åŠ 
        routePoints.forEach((point, index) => {
            // â˜…ä¿®æ­£ç‚¹: ã‚¢ã‚¤ã‚³ãƒ³ã®HTMLç”Ÿæˆæ–¹æ³•ã‚’ä¿®æ­£
            const icon = L.divIcon({
                className: '', // ãƒ©ãƒƒãƒ‘ãƒ¼ã®ã‚¯ãƒ©ã‚¹ã¯ãªã—
                html: `<div class="custom-marker" style="background-color: ${point.color};">${point.label}</div>`,
                iconSize: [36, 36],
                iconAnchor: [18, 18],
                popupAnchor: [0, -20]
            });
            
            const marker = L.marker([point.lat, point.lng], { icon: icon })
                .bindPopup(`
                    <div class="popup-title">${point.name}</div>
                    <div class="popup-desc">${point.desc}</div>
                `)
                .addTo(map);
            
            markers[index] = marker; // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åˆã‚ã›ã¦ãƒãƒ¼ã‚«ãƒ¼ã‚’ä¿å­˜
        });
        
        // åˆæœŸçŠ¶æ…‹ã§å…¨ãƒ«ãƒ¼ãƒˆã‚’è¡¨ç¤º
        showFullRoute();
    }

    // ãƒ«ãƒ¼ãƒˆã®ç·šã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
    function showRoute() {
        if (polyline) {
            map.removeLayer(polyline);
        }
        
        const latlngs = routePoints.map(point => [point.lat, point.lng]);
        polyline = L.polyline(latlngs, {
            color: '#e74c3c',
            weight: 4,
            opacity: 0.7,
            dashArray: '10, 10'
        }).addTo(map);
    }

    // --- ãƒœã‚¿ãƒ³æ“ä½œ ---

    // å…¨ãƒ«ãƒ¼ãƒˆã‚’è¡¨ç¤º
    function showFullRoute() {
        clearInterval(animationInterval);
        const group = L.featureGroup(markers);
        map.fitBounds(group.getBounds().pad(0.2));
        showRoute();
    }

    // ãƒ«ãƒ¼ãƒˆã‚’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º
    function animateRoute() {
        clearInterval(animationInterval);
        let currentIndex = 0;
        
        function nextPoint() {
            if (currentIndex >= routePoints.length) {
                clearInterval(animationInterval);
                // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã«å…¨æ™¯è¡¨ç¤º
                setTimeout(showFullRoute, 1000);
                return;
            }
            focusPoint(currentIndex, true);
            currentIndex++;
        }
        
        nextPoint(); // æœ€åˆã®ãƒã‚¤ãƒ³ãƒˆã‚’ã™ãã«è¡¨ç¤º
        animationInterval = setInterval(nextPoint, 2000);
    }

    // ãƒ«ãƒ¼ãƒˆç·šã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆ
    function toggleRoute() {
        if (!polyline) {
             showRoute();
             return;
        }
        
        if (map.hasLayer(polyline)) {
            map.removeLayer(polyline);
        } else {
            polyline.addTo(map);
        }
    }

    // ç‰¹å®šã®ãƒã‚¤ãƒ³ãƒˆã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
    function focusPoint(index, fromAnimation = false) {
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ä»¥å¤–ã¯ã€é€²è¡Œä¸­ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åœæ­¢
        if (!fromAnimation) {
             clearInterval(animationInterval);
        }
        
        const point = routePoints[index];
        map.setView([point.lat, point.lng], 16, {
            animate: true,
            duration: 1
        });
        
        // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’é–‹ã
        if (markers[index]) {
            setTimeout(() => {
                markers[index].openPopup();
            }, 500); // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
        }
    }

    // === åˆæœŸåŒ– ===
    document.addEventListener('DOMContentLoaded', initMap);
</script>
</body>
</html>